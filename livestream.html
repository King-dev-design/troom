<!DOCTYPE html>
<html lang="en" class="transition duration-300">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Livestream | Troom</title>

  <script src="https://cdn.tailwindcss.com"></script>

  <!-- AOS for animations -->
  <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet"/>
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script>AOS.init();</script>

  <style>
    .countdown span {
      display: inline-block;
      min-width: 60px;
      font-size: 1.25rem;
      padding: 0.25rem 0.5rem;
      border-radius: 0.375rem;
      background-color: rgba(59, 130, 246, 0.1);
    }
  </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white transition duration-300">

  <!-- Responsive Navbar with Toggle -->
<header class="bg-white dark:bg-gray-900 shadow-md transition-colors">
  <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
    <h1 class="text-2xl font-bold text-blue-600 dark:text-white">TRoom</h1>

    <!-- Toggle Buttons (Mobile Only) -->
    <div class="flex items-center">
      <!-- Dark Mode Toggle -->
      <button id="darkToggle" class="mr-4 text-gray-700 dark:text-yellow-400 focus:outline-none text-xl">
        🌙
      </button>

      <!-- Nav Toggle (Hamburger) -->
      <button id="navToggle" class="md:hidden text-gray-700 dark:text-white focus:outline-none">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2"
             viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <!-- Nav Links (Desktop) -->
    <nav class="hidden md:flex space-x-6 text-gray-700 dark:text-white">
      <a href="index.html" class="hover:text-blue-600">Home</a>
      <a href="about.html" class="hover:text-blue-600">About</a>
      <a href="livestream.html" class="hover:text-blue-600">Livestream</a>
      <a href="video.html" class="hover:text-blue-600">Video Hub</a>
      <a href="support.html" class="hover:text-blue-600">Support Us</a>
    </nav>
  </div>

  <!-- Mobile Nav -->
  <div id="mobileNav" class="md:hidden hidden px-4 pb-4 space-y-2 bg-white dark:bg-gray-900">
    <a href="index.html" class="block text-gray-700 dark:text-white hover:text-blue-600">Home</a>
    <a href="about.html" class="block text-gray-700 dark:text-white hover:text-blue-600">About</a>
    <a href="livestream.html" class="block text-gray-700 dark:text-white hover:text-blue-600">Livestream</a>
    <a href="video.html" class="block text-gray-700 dark:text-white hover:text-blue-600">Video Hub</a>
    <a href="support.html" class="block text-gray-700 dark:text-white hover:text-blue-600">Support Us</a>
  </div>
</header>

  <!-- Live banner -->
  <div id="liveBanner" class="hidden bg-red-600 text-white text-center py-2 font-semibold">
    🔴 We are currently LIVE! <a href="#stream" class="underline ml-2">Watch Now</a>
  </div>

  <!-- Main Section -->
  <main class="max-w-5xl mx-auto px-4 py-10">
    <h2 class="text-3xl font-bold text-center mb-6">Our Livestream</h2>
    <p class="text-center text-gray-600 dark:text-gray-400 mb-6">Check if we're live or join our next stream.</p>

    <!-- Countdown -->
    <div id="countdown" class="text-center text-lg font-semibold text-blue-600 dark:text-blue-400 countdown mb-6 animate-pulse">
      🔄 Checking for upcoming livestream...
    </div>

    <!-- Stream Container -->
    <div id="stream" class="w-full aspect-video bg-black rounded shadow overflow-hidden mb-8 flex items-center justify-center text-white">
      <p class="text-center text-sm opacity-50">No livestream loaded yet...</p>
    </div>

    <!-- YouTube Live Chat-->
    <div class="w-full max-w-4xl mt-8">
     <h3 class="text-lg font-semibold mb-2">Live Chat</h3>
      <iframe class="w-full h-96 rounded border border-gray-300 dark:border-gray-700"
          src="https://www.youtube.com/live_chat?v=KPMRVpJ_8Kg&embed_domain=yourdomain.com"
          frameborder="0">
      </iframe>
    </div>

    <!-- Replay Section -->
    <section id="replaySection" class="hidden mt-10">
      <h3 class="text-xl font-semibold mb-4 text-center">📺 Past Livestreams</h3>
      <div id="replayList" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"></div>
    </section>
  </main>

  <!-- Floating WhatsApp Button -->
  <a href="https://wa.me/233555243929" target="_blank"
     class="fixed bottom-6 right-6 z-50 bg-green-500 hover:bg-green-600 text-white rounded-full p-4 shadow-lg transition-all"
     aria-label="Chat on WhatsApp">
    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
      <path d="M12.004 2.001c-5.5 0-9.998 4.498-9.998 9.999 0 1.768.463 3.45 1.345 4.946L2 22l5.227-1.36a9.963 9.963 0 0 0 4.777 1.218c5.5 0 9.996-4.498 9.996-9.998s-4.496-9.999-9.996-9.999zm0 18.2a8.196 8.196 0 0 1-4.176-1.142l-.299-.18-3.101.807.825-3.025-.195-.31a8.204 8.204 0 0 1-1.28-4.393c0-4.534 3.689-8.222 8.225-8.222s8.222 3.688 8.222 8.222c0 4.535-3.687 8.223-8.222 8.223zm4.465-6.183c-.243-.121-1.435-.708-1.658-.788-.223-.081-.386-.121-.548.121-.163.243-.63.789-.773.952-.142.162-.285.182-.528.061-.243-.122-1.028-.378-1.957-1.206-.723-.644-1.211-1.439-1.352-1.681-.142-.243-.015-.375.106-.496.11-.109.244-.284.366-.426.121-.142.161-.243.243-.405.081-.162.04-.304-.02-.426-.061-.122-.548-1.324-.752-1.814-.198-.48-.399-.416-.548-.425l-.466-.01c-.162 0-.426.06-.65.284s-.854.835-.854 2.036c0 1.201.874 2.362.996 2.525.122.162 1.72 2.626 4.168 3.683.583.252 1.038.402 1.393.514.585.186 1.117.16 1.537.097.469-.07 1.435-.586 1.638-1.15.203-.567.203-1.053.142-1.153-.06-.101-.22-.162-.462-.284z"/>
    </svg>
  </a>

  <!-- Footer -->
  <footer class="bg-blue-700 text-white text-center py-6">
    <p>&copy; 2025 TRoom. All rights reserved.</p>
  </footer>

  <!-- YouTube Livestream Script -->
  <script>
    const API_KEY = "AIzaSyBfCuHEH7Ufjsw_QDEyiUYs1x5g5FCmhWI"; // Replace this
    const CHANNEL_ID = "UCv2NUAzJcqPlQ2YMdnryVOg";   // Replace this

    const streamDiv = document.getElementById("stream");
    const countdownEl = document.getElementById("countdown");
    const banner = document.getElementById("liveBanner");
    const replaySection = document.getElementById("replaySection");
    const replayList = document.getElementById("replayList");

    // Get Upcoming Livestream
    fetch(https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&eventType=upcoming&type=video&key=${API_KEY})
      .then(res => res.json())
      .then(data => {
        if (data.items.length > 0) {
          const videoId = data.items[0].id.videoId;
          const scheduledTime = new Date(data.items[0].snippet.publishedAt).getTime();
          streamDiv.innerHTML = <iframe class="w-full h-full" src="https://www.youtube.com/embed/${videoId}?autoplay=0" frameborder="0" allowfullscreen></iframe>;
          startCountdown(scheduledTime);
        } else {
          countdownEl.innerText = "No upcoming livestream.";
        }
      })
      .catch(() => countdownEl.innerText = "Error loading livestream.");

    // Countdown
    function startCountdown(targetTime) {
      const interval = setInterval(() => {
        const now = new Date().getTime();
        const distance = targetTime - now;

        if (distance <= 0) {
          clearInterval(interval);
          countdownEl.innerText = "🔴 We are LIVE!";
          banner.classList.remove("hidden");
        } else {
          const h = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          const m = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
          const s = Math.floor((distance % (1000 * 60)) / 1000);
          countdownEl.innerHTML = `
            ⏳ Starting in:
            <span>${h}h</span> :
            <span>${m}m</span> :
            <span>${s}s</span>
          `;
        }
      }, 1000);
    }

    // Load Past Livestreams
    fetch(https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&eventType=completed&type=video&maxResults=6&key=${API_KEY})
      .then(res => res.json())
      .then(data => {
        if (data.items.length > 0) {
          replaySection.classList.remove("hidden");
          data.items.forEach(item => {
            const vid = item.id.videoId;
            const title = item.snippet.title;
            const thumb = item.snippet.thumbnails.medium.url;
            const videoCard = `
              <a href="https://www.youtube.com/watch?v=${vid}" target="_blank" class="block bg-white dark:bg-gray-800 rounded shadow hover:shadow-lg overflow-hidden">
                <img src="${thumb}" alt="${title}" class="w-full">
                <div class="p-3 text-sm font-medium text-gray-800 dark:text-white">${title}</div>
              </a>
            `;
            replayList.innerHTML += videoCard;
          });
        }
      });
  </script>

  <!-- Dark Mode Toggle -->
  <script>
  // Navbar mobile toggle
  document.getElementById('navToggle').onclick = () => {
    const mobileNav = document.getElementById('mobileNav');
    mobileNav.classList.toggle('hidden');
  };

  // Dark mode toggle
  const toggleBtn = document.getElementById('darkToggle');
  const html = document.documentElement;

  // Load mode from localStorage
  if (localStorage.getItem('theme') === 'dark' || 
     (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
    html.classList.add('dark');
    toggleBtn.textContent = '☀';
  } else {
    html.classList.remove('dark');
    toggleBtn.textContent = '🌙';
  }

  // Toggle logic
  toggleBtn.onclick = () => {
    html.classList.toggle('dark');
    const isDark = html.classList.contains('dark');
    toggleBtn.textContent = isDark ? '☀' : '🌙';
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
  };
</script>
<script>
  tailwind.config = {
    darkMode: 'class'
  }
</script>
</body>
</html>
